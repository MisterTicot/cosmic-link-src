<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">

  <script>
    /*** Immediate redirection if requested by user ***/
    var authenticators = {
      stellarAuthenticator: "https://stellar-authenticator.org/"
    }

    function getAuthenticatorUrl(){
      if(!localStorage.authenticator) localStorage.authenticator = "stellarAuthenticator"
      return authenticators[localStorage.authenticator]
    }

    function redirect(){
      location.replace(getAuthenticatorUrl() + location.search)
      return false
    }

    if (localStorage.redirect == "true" && location.search.length > 1) {
      redirect()
    } else {
      history.replaceState({}, '',
        location.pathname.replace(/[^\/]*$/,'') + location.search)
    }
  </script>

  <title>Cosmic.Link ~ Stellar transactions over URL</title>
  <meta name="description" content="Cosmic.Link provides a convenient way to
  share Stellar transactions as URLs.">

  <meta name="twitter:card" content="summary">
  <meta property="og:title"
    content="Cosmic.Link ~ Stellar transactions over URL">
  <meta property="og:description"
    content="Cosmic.Link provides a convenient way to share Stellar
    transactions as URLs.">

  <meta property="og:image" content="https://test.cosmic.link/icons/180x180.png">
  <meta property="og:image:height" content="180">
  <meta property="og:image:width" content="180">

  <link rel="manifest" href="manifest.json">
  <link rel="mask-icon" href="icons/safari.svg" color="#5bbad5">
  <meta name="msapplication-config" content="browserconfig.xml">
  <meta name="msapplication-TileColor" content="#b91d47">

  <link rel="shortcut icon" href="icons/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="icons/16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/32x32.png">
  <link rel="apple-touch-icon" sizes="192x192" href="icons/192x192.png">

  <link rel="stylesheet" type="text/css" href="main.css">
</head>

<body id="body" onload="lib.start()">

  <img id="tamper">

  <header>
    <h1>Cosmic.Link</h1><span id="query"></span>
  </header>

  <main>
    <div id="main" class="content">
      <h2>You're being offered to sign a Stellar transaction</h2>
      <aside><a href="javascript:lib.switchPage(main, explanation)">What does that mean?</a></aside>
      <hr>
      <h3>Step 1: Check the transaction</h3>
      <div id="CL_htmlNode">
        Loading... <span class="CL_loadingAnim"></span>
      </div>
      <hr>
      <h3>Step 2: Select an authenticator service</h3>
      <form>
        <select id="authenticators" onchange="lib.selectAuthenticator()">
          <option value="stellarAuthenticator">Stellar Authenticator</option>
        </select>
      </form>
      <hr>
      <h3>Step 3: Go & sign the transaction</h3>
      <form onsubmit="return redirect()">
        <input type="submit" value="Sign in my browser">
        <span id="redirect" onClick="lib.switchRedirection()">
          <span id="checkbox">âœ˜</span> Automatic redirection
        </span>
      </form>

      <form>
        <div id="qrcode">
          <input type="button" value="Sign on my phone" onClick="lib.switchQR()">
          <div id="QR"></div>
        </div>
      </form>
    </div>
  </main>

  <div id="hidden">
    <div id="explanation" class="content">
      <p><a href="javascript:lib.switchPage(explanation, main)" class="back">&lt;&lt; Back</a></p>
      <h2>Warm welcome to the Stellar network !</h2>
      <p>
        The Stellar network is a cryptocurrency platform on which we can
        create accounts and perform transactions. It's a bit like a bank,
        except it's public and decentralized.
      </p>
      <p>
        Because it's public, each of us can contribute to the network by
        various means, like programing services such as this one. We can
        also emit our own currencies or tokens, build secure voting systems
        and other things to be invented. :)
      </p>
      <p>
        Because it's properly decentralized, it's protected from anybody
        that could want to disrupt or hijack the network for its own
        benefit. Our funds are secured by cryptographic algorithms and
        resilience. Resilience means that several nodes on the network
        have a full copy of the data, and that the various independent
        nodes have to agree together for the transactions to be performed.
      </p>
      <p>
        In order to sign a Stellar transaction, you need to have an
        account with a minimum amount of the native currency, called
        lumen (XLM). At this time, the minimum amount is 1 lumen, valued
        between $.30 and $.50. Once in, you'll be able to close your
        account and get your money back at any time, if you wish to do so.
      </p>
      <p>
        Cosmic links are normal web links that describe a Stellar
        transaction. When you click on them and own a Stellar account,
        you're given the possibility to sign and send the transaction to
        the network. Those transactions are for payment but also for
        currency conversion, change in account settings or sending short
        messages. Cosmic links may looks like:
        https://cosmic.link/?setOption&...
      </p>
      <p>
        The Stellar network and core programs are maintained by the Stellar
        Foundation. Their <a href="https://stellar.org">website</a> is a good
        place to start if you want to learn more. <br />
        We also have a <a href="https://galactictalk.org">community forum</a>.
      </p>
      <p>
        We wish you a happy discovery :)
      </p>
    </div>
  </div>

  <script src="bower-js-stellar-sdk/stellar-sdk.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
